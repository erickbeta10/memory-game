{% extends 'memory_game/base.html' %}
{% load i18n %} 

{% block content %}
<h1 class="mb-4 text-center text-primary">Panel de Control y Juego Memory_Game</h1>
<div class="row">
    <div class="col-md-5">
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-secondary text-white">
                <h3 class="card-title mb-0"><i class="bi bi-person-circle me-2"></i>Perfil de {{ user.username }}</h3>
            </div>
            <div class="card-body p-0">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-journal-text me-2"></i>Partidas Jugadas:</span> 
                        <strong>{{ stats.total_games_played }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-trophy-fill text-success me-2"></i>Victorias:</span> 
                        <strong>{{ stats.total_victories }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-x-octagon-fill text-danger me-2"></i>Derrotas:</span> 
                        <strong>{{ stats.total_defeats }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-clock-fill me-2"></i>Tiempo Promedio:</span> 
                        <strong>{{ stats.average_time|floatformat:2 }}s</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-star-fill me-2"></i>Nivel Más Jugado:</span> 
                        <strong>{{ stats.most_played_level }}</strong>
                    </li>
                </ul>
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-header bg-dark text-white">
                <h3 class="card-title mb-0"><i class="bi bi-list-columns-reverse me-2"></i>Historial de las ultimas 10 Partidas</h3>
            </div>
            <div class="card-body p-0" style="max-height: 350px; overflow-y: auto;">
                <ul class="list-group list-group-flush">
                    {% if records %}
                        {% for record in records %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span class="badge rounded-pill bg-info text-dark me-2">{{ record.level }}</span>
                                <span class="text-muted small">
                                    {{ record.time_taken|floatformat:2 }}s
                                </span>
                            </div>
                            <span class="badge {% if record.was_won %}bg-success{% else %}bg-danger{% endif %} me-2">
                                {% if record.was_won %}Victoria{% else %}Derrota{% endif %}
                            </span>
                            
                        </li>
                        {% endfor %}
                    {% else %}
                        <li class="list-group-item text-center text-muted py-3">Aún no has jugado ninguna partida.</li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-7">
        <div class="card shadow-lg border-primary">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="card-title mb-0"><i class="bi bi-controller me-2"></i>Selecciona un Nivel para Jugar</h3>
            </div>
            <div class="card-body p-4">
                <p class="lead text-center mb-4">Elige la dificultad. Recuerda que el juego debe ser completado en 60 segundos.</p>
                
                <div class="d-grid gap-4">
                    <a href="{% url 'memory_game:game' level='basico' %}" class="btn btn-primary btn-lg py-3 shadow-sm">
                        <i class="bi bi-star-fill me-2"></i> Básico (6 Intentos)
                    </a>
                    <a href="{% url 'memory_game:game' level='medio' %}" class="btn btn-warning btn-lg py-3 shadow-sm text-dark">
                        <i class="bi bi-star-half me-2"></i> Medio (4 Intentos)
                    </a>
                    <a href="{% url 'memory_game:game' level='avanzado' %}" class="btn btn-danger btn-lg py-3 shadow-sm">
                        <i class="bi bi-star me-2"></i> Avanzado (2 Intentos)
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
{% endblock %}